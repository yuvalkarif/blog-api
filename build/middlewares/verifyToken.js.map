{"version":3,"sources":["../../src/middlewares/verifyToken.js"],"names":["verifyToken","req","res","next","bearerHeader","headers","bearer","split","bearerToken","token","verification","jwt","verify","process","env","JWT_KEY","err","console","log","status","send"],"mappings":";;;;;;;AAAA;;AACA;;;;;;;;AAEA,IAAMA,WAAW;AAAA,+BAAG,WAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB,EAA0B;AAC5C,QAAMC,YAAY,GAAGH,GAAG,CAACI,OAAJ,CAAY,eAAZ,CAArB;;AACA,QAAI,OAAOD,YAAP,KAAwB,WAA5B,EAAyC;AACvC,UAAME,MAAM,GAAGF,YAAY,CAACG,KAAb,CAAmB,GAAnB,CAAf;AACA,UAAMC,WAAW,GAAGF,MAAM,CAAC,CAAD,CAA1B;AACAL,MAAAA,GAAG,CAACQ,KAAJ,GAAYD,WAAZ;AACA,UAAIE,YAAJ;;AAEA,UAAI;AACFA,QAAAA,YAAY,SAASC,sBAAIC,MAAJ,CAAWX,GAAG,CAACQ,KAAf,EAAsBI,OAAO,CAACC,GAAR,CAAYC,OAAlC,CAArB;AAEAZ,QAAAA,IAAI;AACL,OAJD,CAIE,OAAOa,GAAP,EAAY;AACZC,QAAAA,OAAO,CAACC,GAAR,CAAYL,OAAO,CAACC,GAAR,CAAYC,OAAxB;AACAb,QAAAA,GAAG,CAACiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,0BAArB;AACD;AACF,KAdD,MAcO;AACLlB,MAAAA,GAAG,CAACiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,+BAArB;AACD;AACF,GAnBgB;;AAAA,kBAAXpB,WAAW;AAAA;AAAA;AAAA,GAAjB;;eAqBeA,W","sourcesContent":["import \"dotenv\";\nimport jwt from \"jsonwebtoken\";\n\nconst verifyToken = async (req, res, next) => {\n  const bearerHeader = req.headers[\"authorization\"];\n  if (typeof bearerHeader !== \"undefined\") {\n    const bearer = bearerHeader.split(\" \");\n    const bearerToken = bearer[1];\n    req.token = bearerToken;\n    let verification;\n\n    try {\n      verification = await jwt.verify(req.token, process.env.JWT_KEY);\n\n      next();\n    } catch (err) {\n      console.log(process.env.JWT_KEY);\n      res.status(403).send(\"Forbidden, Invalid Token\");\n    }\n  } else {\n    res.status(403).send(\"Forbidden, No Token in Header\");\n  }\n};\n\nexport default verifyToken;\n"],"file":"verifyToken.js"}